## å®éªŒèƒŒæ™¯

ğŸ¤–ï¸ **DB-GPTæ˜¯ä¸€ä¸ªå¼€æºçš„AIåŸç”Ÿæ•°æ®åº”ç”¨å¼€å‘æ¡†æ¶(AI Native Data App Development framework with AWEL(Agentic Workflow Expression Language) and Agents)ã€‚**

ç›®çš„æ˜¯æ„å»ºå¤§æ¨¡å‹é¢†åŸŸçš„åŸºç¡€è®¾æ–½ï¼Œé€šè¿‡å¼€å‘å¤šæ¨¡å‹ç®¡ç†(SMMF)ã€Text2SQLæ•ˆæœä¼˜åŒ–ã€RAGæ¡†æ¶ä»¥åŠä¼˜åŒ–ã€Multi-Agentsæ¡†æ¶åä½œã€AWEL(æ™ºèƒ½ä½“å·¥ä½œæµç¼–æ’)ç­‰å¤šç§æŠ€æœ¯èƒ½åŠ›ï¼Œè®©å›´ç»•æ•°æ®åº“æ„å»ºå¤§æ¨¡å‹åº”ç”¨æ›´ç®€å•ï¼Œæ›´æ–¹ä¾¿ã€‚ 

OceanBase ä» 4.3.3 ç‰ˆæœ¬å¼€å§‹æ”¯æŒäº†å‘é‡æ•°æ®ç±»å‹çš„å­˜å‚¨å’Œæ£€ç´¢ï¼Œå¹¶ä¸”ç»è¿‡é€‚é…å¯ä»¥ä½œä¸º DB-GPT çš„å¯é€‰å‘é‡æ•°æ®åº“ï¼Œæ”¯æŒ DB-GPT å¯¹ç»“æ„åŒ–æ•°æ®å’Œå‘é‡æ•°æ®çš„å­˜å–éœ€æ±‚ï¼Œæœ‰åŠ›åœ°æ”¯æ’‘å…¶ä¸Š LLM åº”ç”¨çš„å¼€å‘å’Œè½åœ°ï¼ŒåŒæ—¶ DB-GPT ä¹Ÿé€šè¿‡ `chat data`ã€`chat db` ç­‰åº”ç”¨ä¸º OceanBase æå‡äº†æ˜“ç”¨æ€§ã€‚


## å®éªŒç¯å¢ƒ

- Git
- [Docker](https://docs.docker.com/engine/install/)
- MySQL å®¢æˆ·ç«¯

## å¹³å°æ­å»ºæ­¥éª¤

### 1. è·å– OceanBase æ•°æ®åº“

è¿›è¡Œå®éªŒä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè·å– OceanBase æ•°æ®åº“ï¼Œç›®å‰å¯è¡Œçš„æ–¹å¼æœ‰ä¸¤ç§ï¼šä½¿ç”¨ OBCloud å®ä¾‹æˆ–è€…[ä½¿ç”¨ Docker æœ¬åœ°éƒ¨ç½²å•æœºç‰ˆ OceanBase æ•°æ®åº“](#ä½¿ç”¨-docker-éƒ¨ç½²å•æœºç‰ˆ-oceanbase-æ•°æ®åº“)ã€‚æˆ‘ä»¬åœ¨æ­¤æ¨è OBCloud å®ä¾‹ï¼Œå› ä¸ºå®ƒéƒ¨ç½²å’Œç®¡ç†éƒ½æ›´åŠ ç®€å•ï¼Œä¸”ä¸éœ€è¦æœ¬åœ°ç¯å¢ƒæ”¯æŒã€‚

#### 1.1 æ³¨å†Œå¹¶å¼€é€š OBCloud å®ä¾‹

è¿›å…¥[OB Cloud äº‘æ•°æ®åº“ 365 å¤©å…è´¹è¯•ç”¨](https://www.oceanbase.com/free-trial)é¡µé¢ï¼Œç‚¹å‡»â€œç«‹å³è¯•ç”¨â€æŒ‰é’®ï¼Œæ³¨å†Œå¹¶ç™»å½•è´¦å·ï¼Œå¡«å†™ç›¸å…³ä¿¡æ¯ï¼Œå¼€é€šå®ä¾‹ï¼Œç­‰å¾…åˆ›å»ºå®Œæˆã€‚

#### 1.2 è·å–æ•°æ®åº“å®ä¾‹è¿æ¥ä¸²

è¿›å…¥å®ä¾‹è¯¦æƒ…é¡µçš„â€œå®ä¾‹å·¥ä½œå°â€ï¼Œç‚¹å‡»â€œè¿æ¥â€-â€œè·å–è¿æ¥ä¸²â€æŒ‰é’®æ¥è·å–æ•°æ®åº“è¿æ¥ä¸²ï¼Œå°†å…¶ä¸­çš„è¿æ¥ä¿¡æ¯å¡«å…¥åç»­æ­¥éª¤ä¸­åˆ›å»ºçš„ .env æ–‡ä»¶å†…ã€‚

![è·å–æ•°æ®åº“è¿æ¥ä¸²](images/get-connection-info.png)

#### 1.3 åˆ›å»ºæ•°æ®åº“

åˆ›å»ºæ•°æ®åº“ä»¥å­˜æ”¾ç¤ºä¾‹æ•°æ®ä»¥åŠå‘é‡æ•°æ®ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è®¾ç½®æ•°æ®åº“åç§°çš„æ—¶å€™ï¼Œä¸ºäº†ä¾¿äºç”¨æˆ·åœ¨ DB-GPT ä¾§è¿›è¡Œåç»­çš„æ“ä½œï¼Œå¼ºçƒˆä¸å»ºè®®ç”¨æˆ·ä½¿ç”¨ä»¥ä¸‹å››ç§åç§°ï¼šï¼ˆå› ä¸ºä»¥ä¸‹å››ç§æ•°æ®åº“åè¢« DB-GPT ä¿ç•™ï¼Œç”¨æˆ·è™½ç„¶èƒ½æˆåŠŸåœ¨ DB-GPT ä¾§å»ºç«‹è¿æ¥ï¼Œä½†æ˜¯æ— æ³•åœ¨ Web UI ä¸­è¿›è¡Œå…¶ä»–æ“ä½œï¼‰

- auth
- dbgpt
- test
- public

![åœ¨ OBCloud ä¸Šåˆ›å»ºå¤šä¸ªæ•°æ®åº“](images/create-db.png)

### 2. å…‹éš†é¡¹ç›®

> ç°åœºä½“éªŒçš„ç”¨æˆ·ï¼Œè¯·åœ¨ç™»å½•ä¸Šäº‘æœåŠ¡å™¨åï¼Œè·³è½¬åˆ°[4. å¯åŠ¨ Docker å®¹å™¨](#4-å¯åŠ¨-docker-å®¹å™¨)

ä¸ºäº†ç®€åŒ–éƒ¨ç½²æµç¨‹ï¼Œæˆ‘ä»¬åŸºäº DB-GPT çš„ 0.6.2 ç‰ˆæœ¬è¿›è¡Œäº†ä¿®æ”¹ï¼Œå¹¶ä¸”ä¸Šä¼ åˆ°äº†æˆ‘ä»¬ fork çš„ä»£ç ä»“åº“ä¸­ã€‚ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤ä¸‹è½½é¡¹ç›®ä»£ç ï¼š

```bash
git clone https://github.com/oceanbase-devhub/DB-GPT
```

### 3. æ‹‰å– Docker é•œåƒ

```bash
docker pull quay.io/oceanbase-devhub/dbgpt:latest
```

### 4. å¯åŠ¨ Docker å®¹å™¨

è¿›å…¥é¡¹ç›®ä»£ç æ‰€åœ¨çš„ç›®å½•ï¼ˆä»¥å…‹éš† DB-GPT é¡¹ç›®æ‰€åœ¨çš„ç›®å½•ä¸ºæ ¹ç›®å½•ï¼‰ï¼š

```bash
cd ./DB-GPT/docker/compose_examples
```

æ‰§è¡Œ `create_container_with_config_check.sh` è„šæœ¬ï¼š

```bash
./create_container_with_config_check.sh
```




## é™„å½•

### ä½¿ç”¨ Docker éƒ¨ç½²å•æœºç‰ˆ OceanBase æ•°æ®åº“

#### 1. å¯åŠ¨ OceanBase å®¹å™¨

æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ä¸€ä¸ª OceanBase docker å®¹å™¨ï¼š

```bash
docker run --name=ob433 -e MODE=mini -e OB_MEMORY_LIMIT=8G -e OB_DATAFILE_SIZE=10G -e OB_CLUSTER_NAME=ailab2024_dbgpt -e OB_SERVER_IP=127.0.0.1 -p 2881:2881 -d quay.io/oceanbase/oceanbase-ce:4.3.3.1-101000012024102216
```

å¦‚æœä¸Šè¿°å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œå°†ä¼šæ‰“å°å®¹å™¨ IDï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```bash
af5b32e79dc2a862b5574d05a18c1b240dc5923f04435a0e0ec41d70d91a20ee
```

#### 2. æ£€æŸ¥ OceanBase æ•°æ®åº“åˆå§‹åŒ–æ˜¯å¦å®Œæˆ

å®¹å™¨å¯åŠ¨åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ OceanBase æ•°æ®åº“åˆå§‹åŒ–çŠ¶æ€ï¼š

```bash
docker logs -f ob433
```

åˆå§‹åŒ–è¿‡ç¨‹å¤§çº¦éœ€è¦ 2 ~ 3 åˆ†é’Ÿã€‚å½“æ‚¨çœ‹åˆ°ä»¥ä¸‹æ¶ˆæ¯ï¼ˆåº•éƒ¨çš„ `boot success!` æ˜¯å¿…é¡»çš„ï¼‰æ—¶ï¼Œè¯´æ˜ OceanBase æ•°æ®åº“åˆå§‹åŒ–å®Œæˆï¼š

```bash
cluster scenario: express_oltp
Start observer ok
observer program health check ok
Connect to observer ok
Initialize oceanbase-ce ok
Wait for observer init ok
+----------------------------------------------+
|                 oceanbase-ce                 |
+------------+---------+------+-------+--------+
| ip         | version | port | zone  | status |
+------------+---------+------+-------+--------+
| 172.17.0.2 | 4.3.3.1 | 2881 | zone1 | ACTIVE |
+------------+---------+------+-------+--------+
obclient -h172.17.0.2 -P2881 -uroot -Doceanbase -A

cluster unique id: c17ea619-5a3e-5656-be07-00022aa5b154-19298807cfb-00030304

obcluster running

...

check tenant connectable
tenant is connectable
boot success!
```

ä½¿ç”¨ `Ctrl + C` é€€å‡ºæ—¥å¿—æŸ¥çœ‹ç•Œé¢ã€‚

#### 3. æµ‹è¯•æ•°æ®åº“éƒ¨ç½²æƒ…å†µï¼ˆå¯é€‰ï¼‰

å¯ä»¥ä½¿ç”¨ mysql å®¢æˆ·ç«¯è¿æ¥åˆ° OceanBase é›†ç¾¤ï¼Œæ£€æŸ¥æ•°æ®åº“éƒ¨ç½²æƒ…å†µã€‚

```bash
mysql -h127.0.0.1 -P2881 -uroot@test -A -e "show databases"
```

å¦‚æœéƒ¨ç½²æˆåŠŸï¼Œæ‚¨å°†çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºï¼š

```bash
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| oceanbase          |
| test               |
+--------------------+
```

#### 4. ä¿®æ”¹å‚æ•°å¯ç”¨å‘é‡æ¨¡å—

å¯é€šè¿‡ä¸‹é¢çš„å‘½ä»¤å°†`test`ç§Ÿæˆ·ä¸‹çš„`ob_vector_memory_limit_percentage`å‚æ•°è®¾ç½®ä¸ºéé›¶å€¼ï¼Œä»¥å¼€å¯ OceanBase çš„å‘é‡åŠŸèƒ½æ¨¡å—ã€‚

```bash
mysql -h127.0.0.1 -P2881 -uroot@test -A -e "alter system set ob_vector_memory_limit_percentage = 30"
```
